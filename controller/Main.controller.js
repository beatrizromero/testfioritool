sap.ui.define(["Coty/RawMaterial/Router","Coty/RawMaterial/util/Commons","Coty/RawMaterial/util/Constants","Coty/RawMaterial/util/Services"],function(e,t,r,i){"use strict";return e.extend("Coty.RawMaterial.controller.Main",{onInit:function(){this.getRouter().getRoute(r.MAIN_VIEW).attachMatched(this.onMatchedRoute,this)},onMatchedRoute:function(){},onSelectionFinishStatus:function(e){let t=e.getParameter("selectedItems");let i=[];t.forEach(e=>{i.push(e.getText())});this.getView().getModel(r.DATAMODEL).setProperty("/Filters/StatusSelected",i)},onBtnPressGo:function(){let e=this.getFilters();this.callServiceGetMaterials(e)},callServiceGetMaterials:function(e){let t=this.getView().getModel(r.DATAMODEL);let o=t.getProperty("/RowsSearched");sap.ui.core.BusyIndicator.show(0);i.getRawMaterials(e,o).then(e=>{sap.ui.core.BusyIndicator.hide();this.getView().getModel(r.DATAMODEL).setProperty("/RawMaterial",e.results)}).catch(e=>{sap.ui.core.BusyIndicator.hide();this.showErrorMessage(e)})},getFilters:function(){let e=this.getView().getModel(r.DATAMODEL);let t=e.getProperty("/Filters/StatusSelected");let i=[];let o=[];if(!!e.getProperty("/Filters/FilterNumber")){o.push(new sap.ui.model.Filter("tolower("+r.FILTER_ARAWMATERIAL_ID+")",sap.ui.model.FilterOperator.Contains,"'"+e.getProperty("/Filters/FilterNumber").toLowerCase()+"'"));o.push(new sap.ui.model.Filter("tolower("+r.FILTER_MPCODE+")",sap.ui.model.FilterOperator.Contains,"'"+e.getProperty("/Filters/FilterNumber").toLowerCase()+"'"));i.push(new sap.ui.model.Filter(o,false))}if(!!e.getProperty("/Filters/FilterCode")){i.push(new sap.ui.model.Filter("tolower("+r.FILTER_CODE+")",sap.ui.model.FilterOperator.Contains,"'"+e.getProperty("/Filters/FilterCode").toLowerCase()+"'"))}if(!!e.getProperty("/Filters/FilterPreferred")){i.push(new sap.ui.model.Filter("tolower("+r.FILTER_APREFERREDNAME+")",sap.ui.model.FilterOperator.Contains,"'"+e.getProperty("/Filters/FilterPreferred").toLowerCase()+"'"))}if(!!e.getProperty("/Filters/FilterInci")){i.push(new sap.ui.model.Filter("tolower("+r.FILTER_AINCINAME+")",sap.ui.model.FilterOperator.Contains,"'"+e.getProperty("/Filters/FilterInci").toLowerCase()+"'"))}let s=[];if(!!t&&!!t.length){t.forEach(e=>{s.push(new sap.ui.model.Filter(r.FILTER_ASTATUS,sap.ui.model.FilterOperator.EQ,e))});i.push(new sap.ui.model.Filter(s,false))}if(!!e.getProperty("/Filters/FilterVendor")){i.push(new sap.ui.model.Filter("tolower("+r.FILTER_AVENDOR+")",sap.ui.model.FilterOperator.Contains,"'"+e.getProperty("/Filters/FilterVendor").toLowerCase()+"'"))}if(!!e.getProperty("/Filters/FilterTrade")){i.push(new sap.ui.model.Filter("tolower("+r.FILTER_ATRADE+")",sap.ui.model.FilterOperator.Contains,"'"+e.getProperty("/Filters/FilterTrade").toLowerCase()+"'"))}return i},onPressMaterial:function(e){let t=this.getView().getModel(r.DATAMODEL);let i=e.getSource().getBindingContext(r.DATAMODEL).getPath();t.setProperty("/MaterialSelected",t.getProperty(i));this.getRouter().navTo(r.DETAIL_VIEW);sap.ui.getCore().getEventBus().publish(r.DETAIL_VIEW,"localNavigation",{})},showErrorMessage:function(e){t.showMessage(this,sap.ui.core.ValueState.Error,sap.ui.core.ValueState.Error,t.errorSimpleMessage(this,e))},onBtnPressNavBack:function(){this.navBack()}})});